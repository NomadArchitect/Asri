@use 'style/base' as *;
@use 'style/main';

html[data-theme-mode="light"]:root {
    color-scheme: light;
    // https://stackoverflow.com/questions/21157231/mac-os-x-scrollbar-is-sometimes-white-transparent-and-sometimes-black-transpare

    @include theme-root($theme-light);
    @include font-family;
    @include cssvars;

    body {
        ::selection {
            background-color: var(--b3-theme-primary-lightest);
        }
    }
}

html[data-theme-mode="dark"]:root {
    color-scheme: dark;

    @include theme-root($theme-dark);
    @include font-family;
    @include cssvars;
}

body {
    -webkit-font-smoothing: auto;

    @include darkmode-counterpart {
        -webkit-font-smoothing: antialiased;
    }

    text-underline-position: under;
}


body:not(.body--mobile) {
    --topbar-z-index: 1;
    --padding-top-for-docks: calc(var(--toolbar-height) - 6px);

    .toolbar {
        margin-bottom: calc(var(--toolbar-height) * -1);
        z-index: var(--topbar-z-index);
        pointer-events: fill;

        #drag {
            opacity: 0;
            pointer-events: none;
        }
    }

    #toolbar {
        --topbar-right-spacing:150px;
        --plugins-container-left:700px;
        --plugins-container-right:246px;

        background-color: transparent;
        border-bottom: none;
    }

    #AsriPluginIconsContainer {
        // -> js
        // outline: 1px solid var(--b3-border-color-trans);
        // outline-offset: -1px;
        width: auto;
        height: 28px;
        align-self: center;
        position: absolute;
        right: var(--plugins-container-right);
        left: var(--plugins-container-left);
        z-index: -1;
        border-radius: 8px;
        background-color: var(--b3-list-hover);
    }

    #AsriTopbarRightSpacing{
        width: var(--topbar-right-spacing);
    }

    // 页签栏
    .fn__flex-column[data-type=wnd]>.fn__flex:first-child {
        z-index: calc(var(--topbar-z-index) + 1);
    }

    .layout-tab-bar {
        margin: 10px;

        &--readonly {
            margin-left: 0;
        }
    }

    .b3-dialog--open .layout-tab-bar {
        margin: 8px auto;
    }

    // 侧栏 ————————————————————————————
    #dockLeft,
    #dockRight {
        padding-top: var(--padding-top-for-docks);
    }

    // 侧栏面板 ——————————————————————————
    .layout__dockl,
    .layout__dockr {

        >.fn__flex:not(.fn__none):first-child,
        >.fn__flex.fn__none~.fn__flex {
            .layout-tab-container {
                padding-top: var(--padding-top-for-docks);
            }
        }

        &.layout--float {
            height: 100%;
        }
    }

    &.body--mac {
        .layout__dockr.layout--float {

            >.fn__flex:not(.fn__none):first-child,
            >.fn__flex.fn__none~.fn__flex {
                .layout-tab-container {
                    padding-top: 4px;
                }
            }
        }
    }

    &.body--win32,
    &.body--browser {
        .layout--float {

            >.fn__flex:not(.fn__none):first-child,
            >.fn__flex.fn__none~.fn__flex {
                .layout-tab-container {
                    padding-top: 4px;
                }
            }
        }
    }

    // 禁用拖动的区域 ————————————————————————————————————
    // 页签栏
    .layout-tab-bar--readonly .block__icon,
    .layout-tab-bar:not(.layout-tab-bar--readonly),

    //菜单
    .b3-menu,
    .b3-menu__submenu,
    .protyle-hint,

    //对话窗口、浮动窗口
    .block__popover,
    .b3-dialog__body,

    //其他
    .block__icons>.block__icon,

    .block__icons>.search__label,

    .search__header,

    .layout--float,

    .protyle-breadcrumb .block__icon,

    .protyle-breadcrumb__item,

    .protyle-breadcrumb button,

    .b3-snackbar,

    .protyle-toolbar,

    .protyle-util {
        app-region: no-drag;
    }
}