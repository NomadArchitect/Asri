!function(){const u={layouts:document.getElementById("layouts"),status:document.getElementById("status"),dockl:document.getElementById("dockLeft"),dockr:document.getElementById("dockRight"),dockb:document.getElementById("dockBottom"),layoutDockl:document.querySelector(".layout__dockl"),layoutDockr:document.querySelector(".layout__dockr"),layoutDockb:document.querySelector(".layout__dockb"),toolbar:document.getElementById("toolbar"),barSync:document.getElementById("barSync"),barForward:document.getElementById("barForward"),toolbarVIP:document.getElementById("toolbarVIP"),drag:document.getElementById("drag"),barPlugins:document.getElementById("barPlugins"),barSearch:document.getElementById("barSearch"),barMode:document.getElementById("barMode")},c=-1<navigator.platform.indexOf("Mac"),l=-1<navigator.platform.indexOf("Linux"),d=document.getElementById("sidebar")&&document.getElementById("editor"),m=0<u.toolbar?.classList.contains("toolbar--browser"),s=0<document.body.classList.contains("body--window");var r="android"===window.siyuan.config.system.container,o=navigator.userAgent;const t=(/iOS/i.test(o)||/iPad/i.test(o))&&/AppleWebKit/i.test(o);o=/^((?!chrome|android).)*safari/i.test(o);const N=window.siyuan.config.lang,p=0<window.siyuan.config.appearance.mode?"dark":"light",O=CSS.supports("color","oklch(from red calc(l * 0.5) 0 h)"),h=[],i=[],f=[],b=(c&&(document.body.classList.add("body--mac"),h.push(".body--mac")),l&&(document.body.classList.add("body--linux"),h.push(".body--linux")),d&&(document.body.classList.add("body--mobile"),h.push(".body--mobile")),m&&(document.body.classList.add("body--browser"),h.push(".body--browser")),r&&(document.body.classList.add("body--android"),h.push(".body--android")),t&&(document.body.classList.add("body--iosApp"),h.push(".body--iosApp")),o&&(document.documentElement.dataset.ua="safari"),!d&&u.toolbar&&(a("AsriPluginsIconsDivider",void 0,u.drag),c&&!m?a("AsriTopbarLeftSpacing",void 0,u.barSync):a("AsriTopbarLeftSpacing",void 0,u.barForward),c||m?a("AsriTopbarRightSpacing"):a("AsriTopbarRightSpacing",u.barSearch)),document.getElementById("AsriPluginsIconsDivider")),R=document.getElementById("AsriTopbarLeftSpacing"),$=document.getElementById("AsriTopbarRightSpacing"),g=u.toolbar;function _(t,e){t.includes(e)||t.push(e)}const v={useSeparateScheme:!1,curScheme:p,schemes:{light:{followSysAccentColor:!0,userCustomColor:"#3478f6",chroma:"1",hueShift:"0"},dark:{followSysAccentColor:!0,userCustomColor:"#3478f6",chroma:"1",hueShift:"0"},universal:{followSysAccentColor:!0,userCustomColor:"#3478f6",chroma:"1",hueShift:"0"}},userPreferredPresets:{light:"",dark:"",universal:""}},j={zh_CN:{followSysAccent:"跟随系统强调色",useSeparateScheme:"当前主题配置：",pickColor:"自定义主题色",asriChroma:"色度：",asriHueShift:"色相偏移：",asriPresetPalettes:"预置配色方案",light:"亮色",dark:"暗色",universal:"全局","asriprst-asri3":"Asri 3.0+","asriprst-obsidian":"Obsidian","asriprst-asri2":"Asri 2.0+","asriprst-materialdesign3":"Material Design 3","asriprst-neutral":"中性","asriprst-redsand":"赤砂","asriprst-minimal":"极简","asriprst-vintage":"复古","asriprst-wisteria":"紫藤","asriprst-lightdream":"浅梦","asriprst-notion":"Notion","asriprst-vacation":"假日","asriprst-foam":"泡沫","asriprst-morningmist":"晨雾","asriprst-mint":"薄荷","asriprst-canyon":"峡谷","asriprst-newyear":"新年","asriprst-dawn":"破晓","asriprst-nightglamour":"夜魅","asriprst-nord":"Nord","asriprst-logseq":"Logseq","asriprst-extraterrestrial":"异星","asriprst-cyberpunk":"赛博朋克","asriprst-ivy":"常春藤","asriprst-lighthouse":"灯塔","asriprst-coffee":"咖啡","asriprst-redwine":"红酒","asriprst-violet":"紫罗兰"},zh_CHT:{followSysAccent:"跟隨系統強調色",useSeparateScheme:"當前主题配置：",pickColor:"自定義主題色",asriChroma:"色度：",asriHueShift:"色相偏移：",asriPresetPalettes:"預置配色方案",light:"淺色",dark:"深色",universal:"全局","asriprst-asri3":"Asri 3.0+","asriprst-obsidian":"Obsidian","asriprst-asri2":"Asri 2.0+","asriprst-materialdesign3":"Material Design 3","asriprst-neutral":"中性","asriprst-redsand":"赤砂","asriprst-minimal":"極簡","asriprst-vintage":"復古","asriprst-wisteria":"紫藤","asriprst-lightdream":"淺夢","asriprst-notion":"Notion","asriprst-vacation":"假日","asriprst-foam":"泡沫","asriprst-morningmist":"晨霧","asriprst-mint":"薄荷","asriprst-canyon":"峽谷","asriprst-newyear":"新年","asriprst-dawn":"破曉","asriprst-nightglamour":"夜魅","asriprst-nord":"Nord","asriprst-logseq":"Logseq","asriprst-extraterrestrial":"異星","asriprst-cyberpunk":"賽博朋克","asriprst-ivy":"常春藤","asriprst-lighthouse":"燈塔","asriprst-coffee":"咖啡","asriprst-redwine":"紅酒","asriprst-violet":"紫羅蘭"},en_US:{followSysAccent:"Follow system accent color",useSeparateScheme:"Current scheme: ",pickColor:"Customize theme color",asriChroma:"Chroma: ",asriHueShift:"Hue shift: ",asriPresetPalettes:"Preset palettes",light:"Light",dark:"Dark",universal:"Universal","asriprst-asri3":"Asri 3.0+","asriprst-obsidian":"Obsidian","asriprst-asri2":"Asri 2.0+","asriprst-materialdesign3":"Material Design 3","asriprst-neutral":"Neutral","asriprst-redsand":"Red Sand","asriprst-minimal":"Minimal","asriprst-vintage":"Vintage","asriprst-wisteria":"Wisteria","asriprst-lightdream":"Light Dream","asriprst-notion":"Notion","asriprst-vacation":"Vacation","asriprst-foam":"Foam","asriprst-morningmist":"Morning Mist","asriprst-mint":"Mint","asriprst-canyon":"Canyon","asriprst-newyear":"New Year","asriprst-dawn":"Dawn","asriprst-nightglamour":"Night Glamour","asriprst-nord":"Nord","asriprst-logseq":"Logseq","asriprst-extraterrestrial":"Extraterrestrial","asriprst-cyberpunk":"Cyberpunk","asriprst-ivy":"Ivy","asriprst-lighthouse":"Lighthouse","asriprst-coffee":"Coffee","asriprst-redwine":"Red Wine","asriprst-violet":"Violet"}},q={universal:[{paletteId:"asriprst-asri3",configs:{userCustomColor:"#3c51ec",chroma:"1.5",hueShift:"0"}},{paletteId:"asriprst-asri2",configs:{userCustomColor:"#3478f6",chroma:"0",hueShift:"0"}},{paletteId:"asriprst-obsidian",configs:{userCustomColor:"#6831f2",chroma:"0",hueShift:"0"}},{paletteId:"asriprst-materialdesign3",configs:{userCustomColor:"#199ef0",chroma:"1.1",hueShift:"60"}},{paletteId:"asriprst-neutral",configs:{userCustomColor:"#d7e1a3",chroma:"0.8",hueShift:"85"}},{paletteId:"asriprst-redsand",configs:{userCustomColor:"#ce985a",chroma:"1",hueShift:"-49"}},{paletteId:"asriprst-minimal",configs:{userCustomColor:"#000000",chroma:"0",hueShift:"20"}}],light:[{paletteId:"asriprst-vintage",configs:{userCustomColor:"#eeb61b",chroma:"1",hueShift:"180"}},{paletteId:"asriprst-wisteria",configs:{userCustomColor:"#49e411",chroma:"2",hueShift:"139"}},{paletteId:"asriprst-lightdream",configs:{userCustomColor:"#e576dc",chroma:"1.2",hueShift:"-70"}},{paletteId:"asriprst-notion",configs:{userCustomColor:"#e0e411",chroma:"0.3",hueShift:"145"}},{paletteId:"asriprst-vacation",configs:{userCustomColor:"#ecde41",chroma:"1.5",hueShift:"118"}},{paletteId:"asriprst-foam",configs:{userCustomColor:"#df729f",chroma:"1.2",hueShift:"-125"}},{paletteId:"asriprst-morningmist",configs:{userCustomColor:"#7dd8d9",chroma:"1",hueShift:"50"}},{paletteId:"asriprst-mint",configs:{userCustomColor:"#55e299",chroma:"1.5",hueShift:"30"}},{paletteId:"asriprst-canyon",configs:{userCustomColor:"#db8757",chroma:"1.2",hueShift:"141"}},{paletteId:"asriprst-newyear",configs:{userCustomColor:"#ffdf0f",chroma:"2.5",hueShift:"-70"}},{paletteId:"asriprst-dawn",configs:{userCustomColor:"#dfa895",chroma:"1",hueShift:"-140"}}],dark:[{paletteId:"asriprst-nightglamour",configs:{userCustomColor:"#8058df",chroma:"3",hueShift:"60"}},{paletteId:"asriprst-nord",configs:{userCustomColor:"#486d7f",chroma:"1.3",hueShift:"-34"}},{paletteId:"asriprst-logseq",configs:{userCustomColor:"#08c7f7",chroma:"4.4",hueShift:"12"}},{paletteId:"asriprst-extraterrestrial",configs:{userCustomColor:"#715ace",chroma:"4",hueShift:"-132"}},{paletteId:"asriprst-cyberpunk",configs:{userCustomColor:"#ea17ee",chroma:"5",hueShift:"-134"}},{paletteId:"asriprst-ivy",configs:{userCustomColor:"#52cb93",chroma:"2.9",hueShift:"-80"}},{paletteId:"asriprst-lighthouse",configs:{userCustomColor:"#7086e1",chroma:"2.1",hueShift:"140"}},{paletteId:"asriprst-coffee",configs:{userCustomColor:"#bb8e86",chroma:"0.4",hueShift:"30"}},{paletteId:"asriprst-redwine",configs:{userCustomColor:"#b960d2",chroma:"1.2",hueShift:"53"}},{paletteId:"asriprst-violet",configs:{userCustomColor:"#5778db",chroma:"2.2",hueShift:"100"}}]},w=t=>("zh_CN"===N||"zh_CHT"===N?j[N]:j.en_US)[t];let y,S,C,B;{async function k(){await async function(t,e,r=!1,o=Date.now()){e=new Blob([e]),e=new File([e],t.split("/").pop());let i=new FormData;i.append("path",t),i.append("file",e),i.append("isDir",r),i.append("modTime",o);const s=await fetch("/api/file/putFile",{body:i,method:"POST",headers:{Authorization:"Token ''"}});return 200===s.status?s.json():null}("/data/snippets/Asri.config.json",JSON.stringify(v,void 0,4))}function V(){let a,n,c,u;setTimeout(()=>{if(!document.querySelector(".asri-config")){const r=document.querySelector('#commonMenu[data-name="barmode"] .b3-menu__items');if(r){var t=`<button class="b3-menu__separator asri-config"></button>
                <button class="b3-menu__item asri-config" id="useSeparateScheme">
                    <svg class="b3-menu__icon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">
                        <g stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
                            <circle cx="12" cy="12" r="10" fill="none" />
                            <path d="M12 18a6 6 0 0 0 0-12z" stroke-width="2" fill="currentColor" />
                        </g>
                    </svg>
                    <label for="" class="be-menu__label">${w("useSeparateScheme")+w(v.curScheme)}
                    </label>
                </button>
                <button class="b3-menu__item asri-config" id="asriPresetPalettes">
                    <svg class="b3-menu__icon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.2"><path d="M11 17a4 4 0 0 1-8 0V5a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2Z"/><path d="M16.7 13H19a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2H7m0-4h.01"/><path d="m11 8l2.3-2.3a2.4 2.4 0 0 1 3.404.004L18.6 7.6a2.4 2.4 0 0 1 .026 3.434L9.9 19.8"/></g></svg>
                    <span class="b3-menu__label">${w("asriPresetPalettes")}</span>
                    <svg class="b3-menu__icon b3-menu__icon--small"><use xlink:href="#iconRight"></use></svg>
                    <div class="b3-menu__submenu">
                        <div class="b3-menu__items"></div>
                    </div>
                </button>
                <button class="b3-menu__separator asri-config"></button>
                <button class="b3-menu__item asri-config" id="pickColor">
                    <svg class="b3-menu__icon"></svg>
                    <label for="asriColorPicker" class="be-menu__label">${w("pickColor")}</label>
                    <input id="asriColorPicker" type="color" value="${v.schemes[v.curScheme].userCustomColor}">
                </button>
                <button class="b3-menu__item asri-config" id="followSysAccent">
                    <svg class="b3-menu__icon"></svg>
                    <label for="" class="be-menu__label">${w("followSysAccent")}</label>
                </button>
                <button class="b3-menu__item asri-config" data-type="nobg" id="asriChroma">
                    <svg class="b3-menu__icon" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24">
                        <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.2"
                            d="m19 11l-8-8l-8.6 8.6a2 2 0 0 0 0 2.8l5.2 5.2c.8.8 2 .8 2.8 0zM5 2l5 5m-8 6h15m5 7a2 2 0 1 1-4 0c0-1.6 1.7-2.4 2-4c.3 1.6 2 2.4 2 4" />
                    </svg>
                    <div aria-label="${w("asriChroma")+c?.value||"1"}"
                        class="b3-tooltips b3-tooltips__n">
                        <input style="box-sizing: border-box" type="range" id="asriChromaSlider" class="b3-slider fn__block" min="0"
                            max="5" step="0.1" value="1">
                    </div>
                </button>
                <button class="b3-menu__item asri-config" data-type="nobg" id="asriHueShift">
                    <svg class="b3-menu__icon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">
                        <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
                            <path d="M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10s-4.477 10-10 10" />
                            <path
                                d="M12 16a4 4 0 1 1 0-8a4 4 0 0 1 0 8m0-14v6m0 8v6M2 12h6m8 0h6M4.929 4.929L9.172 9.17m5.656 5.659l4.243 4.242m-14.142 0l4.243-4.242m5.656-5.658l4.243-4.242" />
                        </g>
                    </svg>
                    <div aria-label="${w("asriHueShift")+u?.value+"º"||"0º"}"
                        class="b3-tooltips b3-tooltips__n"><input style="box-sizing: border-box" type="range" id="asriHueShiftSlider"
                            class="b3-slider fn__block" min="-180" max="180" step="1" value="0">
                    </div>
                    <div class="asri-separator"></div>
                    <svg class="b3-menu__icon" id="textHueShiftBtn"><use xlink:href="#iconFont"></use></svg>
                </button>`,t=document.createRange().createContextualFragment(t);r.appendChild(t),_(h,".asri-config"),a=document.getElementById("followSysAccent"),n=document.getElementById("pickColor"),useSeparateSchemeBtn=document.getElementById("useSeparateScheme"),c=document.getElementById("asriChromaSlider"),colorPicker=n.lastElementChild,u=document.getElementById("asriHueShiftSlider");const o=document.getElementById("asriPresetPalettes").querySelector(".b3-menu__items"),i=new DocumentFragment,s=(e("universal"),v.useSeparateScheme&&e(p),a.classList.toggle("b3-menu__item--selected",S),useSeparateSchemeBtn.classList.toggle("b3-menu__item--selected-alt",v.useSeparateScheme),n.classList.toggle("b3-menu__item--selected",!S),c.value=v.schemes[v.curScheme].chroma||"1",c.parentElement.ariaLabel=w("asriChroma")+c.value,u.value=v.schemes[v.curScheme].hueShift||"0",u.parentElement.ariaLabel=w("asriHueShift")+u.value+"°",v.userPreferredPresets[v.curScheme]&&document.querySelector("#"+v.userPreferredPresets[v.curScheme])?.classList.add("b3-menu__item--selected"),m||d||l?a.classList.add("fn__none"):a.addEventListener("click",()=>{S?(S=!1,a.classList.remove("b3-menu__item--selected"),n.classList.add("b3-menu__item--selected"),document.documentElement.style.setProperty("--asri-user-custom-accent",v.schemes[v.curScheme].userCustomColor||y||"#3478f6"),x(v.schemes[v.curScheme].chroma),v.schemes[v.curScheme].followSysAccentColor=!1):(S=!0,a.classList.add("b3-menu__item--selected"),n.classList.remove("b3-menu__item--selected"),document.documentElement.style.removeProperty("--asri-user-custom-accent"),v.schemes[v.curScheme].followSysAccentColor=!0,U()),k()}),useSeparateSchemeBtn.addEventListener("click",function(){v.useSeparateScheme?(v.useSeparateScheme=!1,this.classList.remove("b3-menu__item--selected-alt"),v.curScheme="universal",document.querySelectorAll(`[data-mode=${p}]`).forEach(t=>t.remove())):(v.useSeparateScheme=!0,this.classList.add("b3-menu__item--selected-alt"),v.curScheme=p,0===document.querySelectorAll(`[data-mode=${p}]`).length&&e(p)),S=v.schemes[v.curScheme].followSysAccentColor,C="0"===v.schemes[v.curScheme].chroma,a.classList.toggle("b3-menu__item--selected",S),n.classList.toggle("b3-menu__item--selected",!S),this.lastElementChild.innerText=w("useSeparateScheme")+w(v.curScheme),c.value=v.schemes[v.curScheme].chroma||"1",c.parentElement.ariaLabel=w("asriChroma")+c.value,u.value=v.schemes[v.curScheme].hueShift||"0",u.parentElement.ariaLabel=w("asriHueShift")+u.value+"°",document.querySelector("#asriPresetPalettes .b3-menu__item--selected")?.classList.remove("b3-menu__item--selected"),document.querySelector("#"+v.userPreferredPresets[v.curScheme])?.classList.add("b3-menu__item--selected"),W(v.curScheme),x(v.schemes[v.curScheme].chroma),k()}),o.addEventListener("click",t=>{var t=t.target.closest(".b3-menu__item");const e=t.id;0===e.indexOf("asriprst-")&&(t=t.dataset.mode)&&(t=q[t].find(t=>t.paletteId===e).configs,e!==v.userPreferredPresets[v.curScheme]&&(v.userPreferredPresets[v.curScheme]=e,Object.assign(v.schemes[v.curScheme],t),W(v.curScheme),document.querySelector("#asriPresetPalettes .b3-menu__item--selected")?.classList.remove("b3-menu__item--selected"),document.querySelector("#"+v.userPreferredPresets[v.curScheme])?.classList.add("b3-menu__item--selected"),S&&(S=!1,a.classList.remove("b3-menu__item--selected"),n.classList.add("b3-menu__item--selected"),document.documentElement.style.setProperty("--asri-user-custom-accent",v.schemes[v.curScheme].userCustomColor||y||"#3478f6"),v.schemes[v.curScheme].followSysAccentColor=!1),C="0"===v.schemes[v.curScheme].chroma,x(v.schemes[v.curScheme].chroma),k()))}),n.addEventListener("click",()=>{S&&(S=!1,a.classList.remove("b3-menu__item--selected"),n.classList.add("b3-menu__item--selected"),document.documentElement.style.setProperty("--asri-user-custom-accent",v.schemes[v.curScheme].userCustomColor),x(v.schemes[v.curScheme].chroma),v.schemes[v.curScheme].userCustomColor=v.schemes[v.curScheme].userCustomColor,v.schemes[v.curScheme].followSysAccentColor=!1,k())}),colorPicker.addEventListener("input",()=>{document.documentElement.style.setProperty("--asri-user-custom-accent",colorPicker.value)}),colorPicker.addEventListener("change",()=>{a.classList.remove("b3-menu__item--selected"),n.classList.add("b3-menu__item--selected"),v.schemes[v.curScheme].userCustomColor=colorPicker.value,S=!1,v.schemes[v.curScheme].followSysAccentColor=!1,k()}),function(e,r){let o=null;return(...t)=>{o&&clearTimeout(o),o=setTimeout(()=>{e(...t)},r)}}(()=>k(),200));function e(r){for(var t in q)t===r&&q[t].forEach(t=>{t=t.paletteId;const e=document.createElement("div");e.classList.add("b3-menu__item"),e.dataset.mode=r,e.id=""+t,e.innerHTML=`<svg class="b3-menu__icon">
                                <use xlink:href="#iconFormat"></use>
                            </svg>
                            <span class="b3-menu__label">${w(t)}</span>`,i.appendChild(e)});o.appendChild(i)}c.addEventListener("input",function(){var t=this.value;document.documentElement.style.setProperty("--asri-c-factor",t),this.parentElement.ariaLabel=w("asriChroma")+t,v.schemes[v.curScheme].chroma=t,C="0"===t,x(t),s()}),u.addEventListener("input",function(){let t=this.value;-10<t&&t<10&&(t=0,this.value=0),document.documentElement.style.setProperty("--asri-h-shift",t),this.parentElement.ariaLabel=w("asriHueShift")+t+"°",v.schemes[v.curScheme].hueShift=t,s()})}}},0)}function U(){if(!(m||d||l)){const r=require("@electron/remote").systemPreferences.getAccentColor();var t="#"+r.slice(0,6),e=function(e){if(e){var r=parseInt(e.substring(1,3),16)/255,o=parseInt(e.substring(3,5),16)/255,i=parseInt(e.substring(5,7),16)/255,e=Math.max(r,o,i),s=Math.min(r,o,i),a=(e+s)/2;if(e===s)return{h:0,s:0,l:a};let t;var n=e-s,s=.5<a?n/(2-e-s):n/(e+s);switch(e){case r:t=(o-i)/n+(o<i?6:0);break;case o:t=(i-r)/n+2;break;case i:t=(r-o)/n+4}return{h:t/=6,s:s,l:a}}}(t);y!==t&&(document.documentElement.style.setProperty("--asri-sys-accent",t),.28<e.s?document.documentElement.style.setProperty("--asri-sys-accent-accessible",t):document.documentElement.style.removeProperty("--asri-sys-accent-accessible"),B=0===e.s,Y(),y=t),S&&x(e.s)}}t||(async function(){await async function(t){try{var e=await fetch("/api/file/getFile",{method:"POST",headers:{Authorization:"Token ''"},body:JSON.stringify({path:t})});return 200===e.status?e:null}catch(t){return console.error("An error occurred while fetching the file:",t),null}}("/data/snippets/Asri.config.json").then(t=>t&&200===t.status?t.json():null).then(t=>{v.useSeparateScheme=t?.useSeparateScheme??!1,v.curScheme=v.useSeparateScheme?p:"universal";for(var e of["light","dark","universal"])v.schemes[e].followSysAccentColor=!t?.schemes||(t.schemes[e].followSysAccentColor??!0),v.schemes[e].userCustomColor=t?.schemes?t.schemes[e].userCustomColor:"#3478f6",v.schemes[e].chroma=t?.schemes?t.schemes[e].chroma:"1",v.schemes[e].hueShift=t?.schemes?t.schemes[e].hueShift:"0",v.userPreferredPresets[e]=t?.userPreferredPresets[e]?t.userPreferredPresets[e]:"";S=!t?.schemes||(t.schemes[v.curScheme].followSysAccentColor??!0),k()})}().then(()=>{O&&(!(m||d||l)&&S?document.documentElement.style.removeProperty("--asri-user-custom-accent"):document.documentElement.style.setProperty("--asri-user-custom-accent",v.schemes[v.curScheme].userCustomColor),document.documentElement.style.setProperty("--asri-c-factor",v.schemes[v.curScheme].chroma),C="0"===v.schemes[v.curScheme].chroma,x(v.schemes[v.curScheme].chroma),U(),V(),W(v.curScheme))}),O&&u.barMode?.addEventListener("click",V))}function W(t){S?document.documentElement.style.removeProperty("--asri-user-custom-accent"):document.documentElement.style.setProperty("--asri-user-custom-accent",v.schemes[t].userCustomColor),document.documentElement.style.setProperty("--asri-c-factor",v.schemes[t].chroma),document.documentElement.style.setProperty("--asri-h-shift",v.schemes[t].hueShift),Y()}function Y(){document.body.classList.add("asri-mode-transition"),setTimeout(()=>{document.body.classList.remove("asri-mode-transition")},350)}function x(t){"0"===(chromaValue=String(t))||S&&B||C?document.documentElement.style.setProperty("--asri-c-0","0"):document.documentElement.style.removeProperty("--asri-c-0")}function e(t,e=t){require("@electron/remote").getCurrentWindow().setWindowButtonPosition({x:t,y:e})}if(c&&!m&&e(16),c&&s&&e(14),c||d)for(let t=0;t<document.styleSheets.length;t++){let r=document.styleSheets[t];try{for(let e=0;e<r.cssRules.length;e++){let t=r.cssRules[e];t.selectorText&&t.selectorText.includes("::-webkit-scrollbar")&&(t.style.width||t.style.height||t.style.backgroundColor)&&(i.push({styleSheet:r,rule:t.cssText}),r.deleteRule(e),e--)}}catch(t){console.log(t)}}function a(e,r=void 0,o=void 0){if(!document.getElementById(e)){let t=document.createElement("div");t.id=e,r?u.toolbar.insertBefore(t,r):o?u.toolbar.insertBefore(t,o.nextSibling):u.toolbar.appendChild(t)}}let J=!1,X,E,G,I=u.drag?.getBoundingClientRect().left,A=u.drag?.getBoundingClientRect().right,K=u.toolbar?.getBoundingClientRect();function Z(){J=!0,clearTimeout(X),X=setTimeout(function(){if(s)P(),setTimeout(()=>{T()},200);else{if(J=!1,c){let t=document.querySelector("#AsriTopbarLeftSpacing");G=!m&&require("@electron/remote").getCurrentWindow().isFullScreen()?(document.body.classList.add("body--fullscreen"),I-=G?0:88,!0):(document.body.classList.remove("body--fullscreen"),t?.style.setProperty("width","0px"),I=u.drag?.getBoundingClientRect().left,t.style.removeProperty("width"),!1)}n(),P(),tt(),setTimeout(()=>{T()},200)}},200)}function n(n){if(!s){let t,e,r,o,i=(t=u.layouts.querySelector(".layout__center")?.getBoundingClientRect(),e=$.getBoundingClientRect(),r=u.barSync.getBoundingClientRect(),barForwardRect=u.barForward.getBoundingClientRect(),window.innerWidth),s=t.left,a=t.right;J?A+=n:(s>I+8?(g.style.setProperty("--topbar-left-spacing",0),I=G?I:u.drag.getBoundingClientRect().left,R.classList.remove("asri-expanded")):(c&&!m?g.style.setProperty("--topbar-left-spacing",s-r.right+4+"px"):g.style.setProperty("--topbar-left-spacing",s-barForwardRect.right+4+"px"),R.classList.add("asri-expanded")),a<A-8?(g.style.setProperty("--topbar-right-spacing",0),A=u.drag.getBoundingClientRect().right,u.dockr?.style.removeProperty("--avoid-topbar"),u.layoutDockr?.style.removeProperty("--avoid-topbar")):c||m?(g.style.setProperty("--topbar-right-spacing",e.right-a+5+"px"),u.dockr?.style.setProperty("--avoid-topbar","4px"),u.layoutDockr?.style.setProperty("--avoid-topbar","4px")):(g.style.setProperty("--topbar-right-spacing",e.right-a+7+"px"),u.dockr?.style.setProperty("--avoid-topbar","calc(var(--toolbar-height) - 6px)"),u.layoutDockr?.style.setProperty("--avoid-topbar","calc(var(--toolbar-height) - 6px)"))),a<A-8?(b.style.setProperty("--container-bg","var(--b3-list-hover)"),b.style.left=a+"px",b.style.right="0",b.style.removeProperty("height"),b.style.removeProperty("top")):(o=u.drag.getBoundingClientRect(),b.style.setProperty("--container-bg","var(--b3-border-color-trans)"),b.style.left=o.right-10+"px",b.style.right=i-o.right+8+"px",b.style.height="21px",b.style.top="13.5px")}}let Q=[];function P(){Q=u.layouts.querySelectorAll('[data-type="wnd"]')}function tt(){s||Q.forEach(t=>{let e=t.querySelector('.fn__flex-column[data-type="wnd"] > .fn__flex:first-child');var r,o,t=e.getBoundingClientRect(),i=u.drag.getBoundingClientRect();L(t,i)||L(t,K)?(r=t.left<i.left?i.left-t.left-4:0,o=t.right>i.right?t.right-i.right+8:0,e.style.paddingLeft=r+"px",e.style.paddingRight=o+"px",t.right-o-240<i.left&&t.left<i.left||t.left+r+240>i.right&&t.right>i.right?(e.style.paddingTop="42px",e.style.paddingLeft=0,e.style.paddingRight=0):e.style.removeProperty("padding-top")):(e.style.removeProperty("padding-left"),e.style.removeProperty("padding-right"))})}function T(){Q.forEach(t=>{let e=t.querySelector(".file-tree")?[]:t.querySelectorAll(".protyle-wysiwyg");0<e.length&&setTimeout(()=>{e.forEach(t=>{var e=t.style.paddingLeft;e!==t.dataset.prevpadding&&(t.style.setProperty("--protyle-spacing",e),t.dataset.prevpadding=e)})},300)})}if(!d){if(setTimeout(n,200),!s){let r=u.layouts.querySelector(".layout__center");const F=new ResizeObserver(t=>{for(var e of t){var r,o=e.contentBoxSize[0]["inlineSize"];e.target.dataset.prevWidth?(r=o-parseFloat(e.target.dataset.prevWidth),e.target.dataset.prevWidth=o,P(),clearTimeout(E),E=setTimeout(()=>{ct(),T()},200),n(r),tt(),M()):e.target.dataset.prevWidth=o}});if(r)F.observe(r),f.push(F);else{let t=0,e;function et(){u.layouts=document.getElementById("layouts"),r=u.layouts.querySelector(".layout__center"),10!==++t&&!r||(clearInterval(e),F.observe(r),f.push(F))}setTimeout(()=>{e=setInterval(et,1e3)},0)}}window.addEventListener("resize",Z)}function rt(t="l"){return u["dock"+t]&&u["dock"+t].classList.contains("fn__none")}function ot(){return u.dockb&&!u.dockb.classList.contains("fn__none")}function it(){var t=ot(),e=function(){if(!d){const t=u.layouts,e=t.querySelector(".layout__dockb");return t&&e?.classList.contains("layout--float")&&"0px"!==e?.style.height}}();u.toolbar?.nextElementSibling.classList.toggle("has-dockb",t),u.toolbar?.nextElementSibling.classList.toggle("has-layout-dockb-float",e),u.dockb?.classList.toggle("has-layout-dockb-float",e),_(h,".has-dockb"),_(h,".has-layout-dockb-float")}function st(){return u.status&&u.status.classList.contains("fn__none")}function at(t){return t&&!t.classList.contains("layout--float")}function nt(t){return"0px"!==t?.style.width}function M(){if(u.dockl&&!d&&!s)for(var r of["l","r"]){let t=u["layoutDock"+r],e=u["dock"+r];if(at(t)&&nt(t)?(e.classList.add("dock-layout-expanded"),_(h,".dock-layout-expanded")):e.classList.remove("dock-layout-expanded"),!rt()&&(at(o=t)||!o?.style.cssText.includes("transform: translate"))&&nt(t))switch(r){case"l":case"r":e.style.setProperty("--border-clr","transparent")}else e.style.removeProperty("--border-clr")}var o}function ct(){function t(t,e){u.status.style.transform=`translate(${t}px, ${e}px)`}var e,r,o,i;d||s||(ot()?(u.status?.style.removeProperty("max-width"),u.status?.style.removeProperty("transform")):(o=u.layouts.querySelector(".layout__center"))&&u.layoutDockr&&!u.status.classList.contains(".fn__none")&&(e=u.layoutDockr.clientWidth,o=o.clientWidth,u.layoutDockb=u.layouts.querySelector(".layout__dockb"),r=u.layoutDockb&&!u.layoutDockb.classList.contains(".fn__none")&&at(u.layoutDockb)?-1*u.layoutDockb.clientHeight:0,u.status.style.maxWidth=o-12+"px",o=rt("r"),i=function(t){let e=u["layoutDock"+t];return e&&(e.classList.contains("layout--float")||e.style.cssText.includes("width: 0px"))}("r"),o&&i?t(0,r):!o&&i?t(-40,r):o||i?o&&!i&&t(-1*e,r):t(-1*(e+40),r),u.status=document.getElementById("status")))}function ut(){st()?document.body.style.setProperty("--status-height","0px"):document.body.style.setProperty("--status-height","32px")}function D(){if(!st()){let t=u.layouts?.querySelectorAll(".layout__center .layout-tab-container"),r=u.status.getBoundingClientRect(),e=(t?.forEach(t=>{let e=t.querySelector(".file-tree");e&&!e.classList.contains("fn__none")&&L(t.getBoundingClientRect(),r)?t.style.paddingBottom="35px":t.style.removeProperty("padding-bottom")}),document.getElementById("searchList")),o=document.getElementById("searchPreview");var s,a;(e||o)&&(s=e.getBoundingClientRect(),a=o.getBoundingClientRect(),L(s,r)?e.style.paddingBottom="35px":e.style.removeProperty("padding-bottom"),L(a,r)?o.style.paddingBottom="35px":o.style.removeProperty("padding-bottom"));let i=document.getElementById("viewerContainer");i&&(L(i.getBoundingClientRect(),r)?i.style.paddingBottom="35px":i.style.removeProperty("padding-bottom")),u.layouts?.querySelectorAll(".card__main").forEach(t=>{t&&(L(t.getBoundingClientRect(),r)?t.style.paddingBottom="35px":t.style.removeProperty("padding-bottom"))})}}function L(t,e){return t&&e&&(t.right>e.left&&t.bottom>e.top&&t.left<e.left+e.width&&t.top<e.top+e.height)}function lt(){if(!d){let t=document.querySelectorAll(".file-tree .b3-list-item--focus");document.querySelectorAll(".file-tree .has-focus").forEach(t=>t.classList.remove("has-focus")),t.forEach(t=>{t.nextElementSibling&&"UL"===t.nextElementSibling.tagName&&!t.nextElementSibling.classList.contains("fn__none")||(t.parentNode.classList.add("has-focus"),_(h,".has-focus"))})}}function dt(r,o){return new MutationObserver(function(t,e){t.forEach(t=>{t.type===r&&o(t,e)})})}function mt(r,o=void 0,i=void 0){return new MutationObserver(function(t,e){t.forEach(t=>{r&&"childList"===t.type?r(t,e):o&&"attributes"===t.type?o(t,e):i&&"characterData"===t.type&&i(t,e)})})}function pt(r,t,e=void 0,o=void 0,i=!1){let s={},a=(t&&(s.childList=!0),e&&(s.attributes=!0),o&&(s.characterData=!0),t&&i&&(s.subtree=!0),u["layoutDock"+r]),n=mt(t,e,o);if(a)n.observe(a,s),f.push(n);else{let t=0,e;function c(){a=u.layouts.querySelector(".layout__dock"+r),10!==++t&&!a||(clearInterval(e),u["layoutDock"+r]=a,M(),n.observe(a,s),f.push(n))}setTimeout(()=>{e=setInterval(c,1e3)},0)}}it(),M(),ut(),D(),lt();{var[r,o=void 0,H=!1]=[()=>{{let t=document.querySelectorAll(".b3-dialog--open .b3-dialog");t.forEach(t=>{t.querySelector(".emojis")&&(t.classList.add("emojis-container"),_(h,".emojis-container"))})}it(),document.body.classList.toggle("has-exportimg",document.querySelector('[data-key="dialog-exportimage"]')),_(h,".has-exportimg")}];let t={},e=(r&&(t.childList=!0),o&&(t.attributes=!0),r&&H&&(t.subtree=!0),mt(r,o));e.observe(document.body,t),f.push(e)}if(!d&&!s){pt("l",void 0,()=>{setTimeout(()=>{D()},200),M()}),pt("r",void 0,()=>{setTimeout(()=>{D()},200),M()});{H="attributes";r=ut;o=u.status;let t=dt(H,r);o&&(t.observe(o,{[H]:!0}),f.push(t))}}function z(){d||setTimeout(()=>{P();{let t=document.querySelector("#AsriTopbarLeftSpacing"),e=document.querySelector("#AsriTopbarRightSpacing");t?.style.setProperty("width","0px"),e?.style.setProperty("width","0px"),I=u.drag?.getBoundingClientRect().left,A=u.drag?.getBoundingClientRect().right,t?.style.removeProperty("width"),e?.style.removeProperty("width")}n(),tt(),T(),lt();{let t=u.layouts?.querySelectorAll(".protyle .protyle-background");t.forEach(t=>{!t.querySelector(".protyle-background__img img")?.classList.contains("fn__none")&&t.querySelector(".protyle-background__icon.fn__none")?(t.classList.add("without-icon"),_(h,".without-icon")):t.classList.remove("without-icon")})}D(),it(),ct(),!t&&S&&O&&U()},200)}function ht(t){"Control"!==t.key&&"Alt"!==t.key&&"Shift"!==t.key&&"Meta"!==t.key||z()}function ft(t){document.body.style.setProperty("--mouseX",t.clientX+"px"),document.body.style.setProperty("--mouseY",t.clientY+"px")}z(),window.addEventListener("mouseup",z),window.addEventListener("dragend",z),window.addEventListener("keyup",ht),window.addEventListener("dblclick",ft),window.destroyTheme=()=>{if(window.removeEventListener("mouseup",z),window.removeEventListener("keyup",ht),window.removeEventListener("dragend",z),window.removeEventListener("dblclick",ft),window.removeEventListener("resize",Z),u.barMode?.removeEventListener("click",V),f.forEach(t=>t.disconnect()),c&&!m&&e(8),c&&s&&e(8,13),h.forEach(e=>{document.querySelectorAll(e).forEach(t=>t.classList.remove(e.slice(1)))}),document.querySelector("#AsriTopbarLeftSpacing")?.remove(),document.querySelector("#AsriTopbarRightSpacing")?.remove(),document.querySelector("#AsriPluginsIconsDivider")?.remove(),document.documentElement.dataset.ua="",document.body.style.removeProperty("--mouseX"),document.body.style.removeProperty("--mouseY"),document.body.style.removeProperty("--status-height"),document.documentElement.style.removeProperty("--asri-sys-accent"),document.documentElement.style.removeProperty("--asri-sys-accent-accessible"),document.documentElement.style.removeProperty("--asri-sys-accent-grayscale"),document.documentElement.style.removeProperty("--asri-user-custom-accent"),document.documentElement.style.removeProperty("--asri-c-factor"),document.documentElement.style.removeProperty("--asri-c-0"),document.querySelectorAll(".dock").forEach(t=>{t.style.removeProperty("--border-clr")}),setTimeout(()=>{u.toolbar?.style.removeProperty("--topbar-left-spacing"),u.toolbar?.style.removeProperty("--topbar-right-spacing"),u.dockr?.style.removeProperty("--avoid-topbar"),u.layoutDockr?.style.removeProperty("--avoid-topbar"),u.status?.style.removeProperty("max-width"),u.status?.style.removeProperty("transform");const t=document.body.querySelectorAll('[data-type="wnd"]'),e=(t.forEach(t=>{const e=t.firstElementChild,r=t.querySelectorAll(".protyle-wysiwyg");e?.style.removeProperty("padding-left"),e?.style.removeProperty("padding-right"),e?.style.removeProperty("padding-top"),r.forEach(t=>{t.style.removeProperty("--protyle-spacing"),t.dataset.prevpadding=void 0})}),u.layouts?.querySelectorAll(".layout__center .layout-tab-container"));e.forEach(t=>{t.style.removeProperty("padding-bottom")})},200),document.getElementById("searchList")?.style.removeProperty("padding-bottom"),document.getElementById("searchPreview")?.style.removeProperty("padding-bottom"),document.getElementById("viewerContainer")?.style.removeProperty("padding-bottom"),u.layouts.querySelectorAll(".card__main").forEach(t=>{t.style.removeProperty("padding-bottom")}),i)for(let e=0;e<i.length;e++){let t=i[e];t.styleSheet.insertRule(t.rule,t.styleSheet.cssRules.length)}Y()}}();